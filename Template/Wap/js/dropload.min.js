!function(a){"use strict";function e(a){a.touches||(a.touches=a.originalEvent.touches)}function f(a,d){d._startY=a.touches[0].pageY,d.opts.scrollArea==window?(d._meHeight=b.height(),d._childrenHeight=c.height()):(d._meHeight=d.$element.height(),d._childrenHeight=d.$element.children().height()),d._scrollTop=d.$scrollArea.scrollTop()}function g(a,b){function c(){b.$domDown.html(b.opts.domDown.domLoad),b.loading=!0,b.opts.loadDownFn(b)}""===b.opts.threshold?b._threshold=Math.floor(1*b._childrenHeight/5):b._threshold=b.opts.threshold,""!=b.opts.loadDownFn&&!b.loading&&b._childrenHeight-b._threshold<=b._meHeight+b._scrollTop&&c()}var b=a(window),c=a(document);a.fn.dropload=function(a){return new d(this,a)};var d=function(b,c){var d=this;d.$element=a(b),d.loading=!1,d.isLock=!1,d.isData=!0,d.init(c)};d.prototype.init=function(c){var d=this;d.opts=a.extend({},{scrollArea:d.$element,domDown:{domClass:"dropload-down",domRefresh:'<div class="dropload-refresh">\u2191\u4e0a\u62c9\u52a0\u8f7d\u66f4\u591a</div>',domLoad:'<div class="dropload-load"><span class="loading"></span>\u52a0\u8f7d\u4e2d...</div>',domNoData:'<div class="dropload-noData">\u795e\u9a6c\u90fd\u6ca1\u6709\u4e86</div>'},distance:50,threshold:"",loadDownFn:""},c),""!=d.opts.loadDownFn&&(d.$element.append('<div class="'+d.opts.domDown.domClass+'">'+d.opts.domDown.domRefresh+"</div>"),d.$domDown=a("."+d.opts.domDown.domClass)),d.opts.scrollArea==window?d.$scrollArea=b:d.$scrollArea=d.opts.scrollArea,d.$element.on("touchstart",function(a){d.loading||d.isLock||(e(a),f(a,d))}),d.$element.on("touchmove",function(a){d.loading||d.isLock||(e(a),g(a,d))})},d.prototype.lock=function(){var a=this;a.isLock=!0},d.prototype.unlock=function(){var a=this;a.isLock=!1},d.prototype.nodata=function(){var a=this;a.$domDown.html(a.opts.domDown.domNoData),a.isData=!1},d.prototype.resetload=function(){var a=this;a.loading=!1,a.isData?a.$domDown.html(a.opts.domDown.domRefresh):a.$domDown.html(a.opts.domDown.domNoData)}}(window.Zepto||window.jQuery);